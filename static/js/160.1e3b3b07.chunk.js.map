{"version":3,"file":"static/js/160.1e3b3b07.chunk.js","mappings":"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","sources":["../../node_modules/@kne/compose/src/index.js","../../node_modules/@kne/use-ref-callback/src/index.js","../../node_modules/@kne/with-layer/src/preset.js","../../node_modules/@kne/with-layer/src/index.js","../../node_modules/react-dom/client.js"],"sourcesContent":["/**\n * @name: compose ;\n * @author: linzp ;\n * @description: 实现方法的调用串联 ;\n * */\n\nexport default function compose(...funcs) {\n    if (funcs.length === 0) {\n        return arg => arg\n    }\n\n    if (funcs.length === 1) {\n        return funcs[0]\n    }\n\n    return funcs.reduce((a, b) => (...args) => a(b(...args)))\n}","import { useRef, useCallback } from \"react\";\n\nconst useRefCallback = (callback, keepInit = false) => {\n  const callbackRef = useRef(callback);\n  if (!keepInit) {\n    callbackRef.current = callback;\n  }\n  return useCallback((...args) => {\n    return callbackRef.current && callbackRef.current(...args);\n  }, []);\n};\n\nexport default useRefCallback;\n","import React from \"react\";\r\n\r\nexport const global = {\r\n  getContainer: null,\r\n  withInstall: (WrappedComponent) => (props) => <WrappedComponent {...props} />\r\n};\r\n\r\nexport const preset = (options) => {\r\n  return Object.assign(global, options);\r\n};\r\n\r\nexport default preset;\r\n","import ReactDOM from \"react-dom/client\";\r\nimport compose from \"@kne/compose\";\r\nimport React, { createRef, useState, useImperativeHandle, useEffect } from \"react\";\r\nimport useRefCallback from \"@kne/use-ref-callback\";\r\nimport { global } from \"./preset\";\r\n\r\nconst withLayer = WrappedComponent => {\r\n  return ({ onCancel, onDestroy, outRef, onMount, onOk, ...props }) => {\r\n    const [visible, setVisible] = useState(false);\r\n    useImperativeHandle(outRef, () => {\r\n      return {\r\n        close: () => setVisible(false), setVisible, visible\r\n      };\r\n    }, [visible, setVisible]);\r\n\r\n    const mount = useRefCallback(onMount);\r\n\r\n    useEffect(() => {\r\n      mount();\r\n      setVisible(true);\r\n    }, [mount]);\r\n\r\n    return (<WrappedComponent\r\n      {...props}\r\n      open={visible}\r\n      close={() => setVisible(false)}\r\n      onOk={async () => {\r\n        if (!onOk) {\r\n          setVisible(false);\r\n          return;\r\n        }\r\n        const res = await onOk();\r\n        if (res !== false) {\r\n          setVisible(false);\r\n        }\r\n      }}\r\n      onCancel={(...args) => {\r\n        setVisible(false);\r\n        onCancel && onCancel(...args);\r\n      }}\r\n      afterClose={onDestroy}\r\n    />);\r\n  };\r\n};\r\n\r\nconst createWithLayer = WrappedComponent => {\r\n  const ref = createRef(null);\r\n  return (args) => {\r\n    const body = global.getContainer && global.getContainer() || document.body;\r\n    const root = document.createElement(\"div\");\r\n    const { withInstall, getContainer, ...props } = Object.assign({}, args);\r\n    body.appendChild(root);\r\n    const rootDom = ReactDOM.createRoot(root);\r\n    const promise = new Promise((resolve) => {\r\n      const LayerInstance = compose(withLayer, global.withInstall)(typeof withInstall === \"function\" ? withInstall(WrappedComponent) : WrappedComponent);\r\n      rootDom.render(<LayerInstance\r\n        outRef={ref}\r\n        {...props}\r\n        getContainer={getContainer || (() => root)}\r\n        onDestroy={() => {\r\n          root.style.opacity = \"0\";\r\n          body.removeChild(root);\r\n          setTimeout(() => {\r\n            rootDom.unmount();\r\n          }, 0);\r\n        }}\r\n        onMount={() => {\r\n          resolve({\r\n            close: ref.current.close\r\n          });\r\n        }}\r\n      />);\r\n    });\r\n\r\n    const close = () => {\r\n      return promise.then(({ close }) => {\r\n        close();\r\n      });\r\n    };\r\n    return {\r\n      close, current: { close }\r\n    };\r\n  };\r\n};\r\n\r\nexport default createWithLayer;\r\nexport { preset } from \"./preset\";\r\n","'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n"],"names":["_len","arguments","length","funcs","Array","_key","arg","reduce","a","b","apply","useRefCallback","callback","keepInit","undefined","callbackRef","useRef","current","useCallback","global","getContainer","withInstall","WrappedComponent","props","React","preset","options","Object","assign","withLayer","_ref","onCancel","onDestroy","outRef","onMount","onOk","_objectWithoutPropertiesLoose","_excluded","visible","setVisible","useState","useImperativeHandle","close","mount","useEffect","_extends","open","async","afterClose","createWithLayer","ref","createRef","args","body","document","root","createElement","_Object$assign","_excluded2","appendChild","rootDom","ReactDOM","promise","Promise","resolve","LayerInstance","compose","render","style","opacity","removeChild","setTimeout","unmount","then","_ref2","m","require","exports","createRoot","hydrateRoot"],"sourceRoot":""}